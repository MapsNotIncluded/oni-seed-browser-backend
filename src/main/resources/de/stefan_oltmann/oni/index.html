<html>

<body>

<script>
// (A) POST FILE WITH FETCH
function fetchFile() {
  // (A1) GET THE FILE INPUT ELEMENT
  let fileInput = document.getElementById("fileInput");

  // (A2) CREATE A NEW FILE READER
  let reader = new FileReader();

  // (A3) SET UP THE CALLBACK FOR WHEN THE FILE IS LOADED
  reader.onload = function () {
    // (A4) GET THE FILE CONTENT AS A BLOB
    let fileContent = new Blob([reader.result]);

    // (A5) FETCH
    fetch("http://localhost:8080/upload", {
      method: "post",
      body: fileContent
    })
      .then(res => res.text())
      .then(txt => {
       // (B) DISPLAY TEXT ON THE PAGE
       let resultElement = document.createElement("p");
       resultElement.textContent = txt;
       document.body.appendChild(resultElement);
      })
      .catch(err => console.log(err));
  };

 // (A6) READ THE FILE AS ARRAY BUFFER
 reader.readAsArrayBuffer(fileInput.files[0]);
}
</script>

<!-- (C) FILE INPUT ELEMENT -->
<input type="file" id="fileInput">
<input type="button" value="POST File" onclick="fetchFile()">

</body>
</html>
